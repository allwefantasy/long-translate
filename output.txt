ä¸ºäº†æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ index.wxml å’Œ index.ts æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç•Œé¢ä¸Šæ·»åŠ ä¸€ä¸ª"ç»§ç»­"æŒ‰é’®ï¼Œç„¶ååœ¨ç»„ä»¶ä¸­æ·»åŠ ç›¸åº”çš„çŠ¶æ€å’Œæ–¹æ³•æ¥å¤„ç†è¿™ä¸ªæ–°åŠŸèƒ½ã€‚

è®©æˆ‘ä»¬å…ˆä¿®æ”¹ index.wxml æ–‡ä»¶ï¼š

```python
##File: /Users/allwefantasy/WeChatProjects/long-translate/miniprogram/pages/index/index.wxml
<<<<<<< SEARCH
<view class="card translation-result" wx:if="{{translationResult}}">
  <text class="card-title">ç¿»è¯‘ç»“æœ</text>
  <view class="result-text">{{translationResult}}</view>
  <button class="download-button" bindtap="downloadTranslation">
    <text class="icon">â¬‡ï¸</text> ä¸‹è½½ç»“æœ
  </button>
</view>
=======
<view class="card translation-result" wx:if="{{translationResult}}">
  <text class="card-title">ç¿»è¯‘ç»“æœ</text>
  <view class="result-text">{{translationResult}}</view>
  <view class="button-group">
    <button class="download-button" bindtap="downloadTranslation">
      <text class="icon">â¬‡ï¸</text> ä¸‹è½½ç»“æœ
    </button>
    <button class="continue-button" bindtap="continueTranslation" wx:if="{{isDownloading}}">
      <text class="icon">ğŸ”„</text> ç»§ç»­
    </button>
  </view>
</view>
>>>>>>> REPLACE
```

ç°åœ¨è®©æˆ‘ä»¬ä¿®æ”¹ index.ts æ–‡ä»¶æ¥æ·»åŠ æ–°çš„çŠ¶æ€å’Œæ–¹æ³•ï¼š

```python
##File: /Users/allwefantasy/WeChatProjects/long-translate/miniprogram/pages/index/index.ts
<<<<<<< SEARCH
Component({
  data: {
    fileName: '',
    translationResult: '',
    languages: [
      { code: 'en', name: 'è‹±è¯­' },
      { code: 'zh', name: 'ä¸­æ–‡' },
      { code: 'es', name: 'è¥¿ç­ç‰™è¯­' },
      { code: 'fr', name: 'æ³•è¯­' },
      { code: 'de', name: 'å¾·è¯­' },
      { code: 'ja', name: 'æ—¥è¯­' },
      { code: 'ko', name: 'éŸ©è¯­' },
      { code: 'ru', name: 'ä¿„è¯­' },
      { code: 'ar', name: 'é˜¿æ‹‰ä¼¯è¯­' },
      { code: 'pt', name: 'è‘¡è„ç‰™è¯­' },
      { code: 'it', name: 'æ„å¤§åˆ©è¯­' },
    ],
    languageIndex: 0,
  },
=======
Component({
  data: {
    fileName: '',
    translationResult: '',
    languages: [
      { code: 'en', name: 'è‹±è¯­' },
      { code: 'zh', name: 'ä¸­æ–‡' },
      { code: 'es', name: 'è¥¿ç­ç‰™è¯­' },
      { code: 'fr', name: 'æ³•è¯­' },
      { code: 'de', name: 'å¾·è¯­' },
      { code: 'ja', name: 'æ—¥è¯­' },
      { code: 'ko', name: 'éŸ©è¯­' },
      { code: 'ru', name: 'ä¿„è¯­' },
      { code: 'ar', name: 'é˜¿æ‹‰ä¼¯è¯­' },
      { code: 'pt', name: 'è‘¡è„ç‰™è¯­' },
      { code: 'it', name: 'æ„å¤§åˆ©è¯­' },
    ],
    languageIndex: 0,
    isDownloading: false,
  },
>>>>>>> REPLACE
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ downloadTranslation æ–¹æ³•å’Œæ·»åŠ  continueTranslation æ–¹æ³•ï¼š

```python
##File: /Users/allwefantasy/WeChatProjects/long-translate/miniprogram/pages/index/index.ts
<<<<<<< SEARCH
    downloadTranslation() {
      if (!this.data.translationResult) {
        wx.showToast({
          title: 'æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹',
          icon: 'none'
        })
        return
      }
      
      wx.showActionSheet({
        itemList: ['ä¿å­˜åˆ°ç›¸å†Œ', 'ä¿å­˜åˆ°æ–‡ä»¶'],
        success: (res) => {
          if (res.tapIndex === 0) {
            this.saveToAlbum()
          } else if (res.tapIndex === 1) {
            this.saveToFile()
          }
        },
        fail: (res) => {
          console.log(res.errMsg)
        }
      })
    },
=======
    downloadTranslation() {
      if (!this.data.translationResult) {
        wx.showToast({
          title: 'æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹',
          icon: 'none'
        })
        return
      }
      
      this.setData({ isDownloading: true })
      
      wx.showActionSheet({
        itemList: ['ä¿å­˜åˆ°ç›¸å†Œ', 'ä¿å­˜åˆ°æ–‡ä»¶'],
        success: (res) => {
          if (res.tapIndex === 0) {
            this.saveToAlbum()
          } else if (res.tapIndex === 1) {
            this.saveToFile()
          }
        },
        fail: (res) => {
          console.log(res.errMsg)
          this.setData({ isDownloading: false })
        }
      })
    },

    continueTranslation() {
      this.setData({
        fileName: '',
        translationResult: '',
        isDownloading: false
      })
      this.filePath = ''
    },
>>>>>>> REPLACE
```

æœ€åï¼Œæˆ‘ä»¬éœ€è¦åœ¨ saveToAlbum å’Œ saveToFile æ–¹æ³•çš„æˆåŠŸå›è°ƒä¸­æ·»åŠ çŠ¶æ€é‡ç½®ï¼š

```python
##File: /Users/allwefantasy/WeChatProjects/long-translate/miniprogram/pages/index/index.ts
<<<<<<< SEARCH
    saveToAlbum() {
      const ctx = wx.createCanvasContext('translationCanvas')
      ctx.setFillStyle('#ffffff')
      ctx.fillRect(0, 0, 300, 450)
      ctx.setFontSize(14)
      ctx.setFillStyle('#000000')
      ctx.fillText(this.data.translationResult, 10, 30, 280)
      ctx.draw(false, () => {
        wx.canvasToTempFilePath({
          canvasId: 'translationCanvas',
          success: (res) => {
            wx.saveImageToPhotosAlbum({
              filePath: res.tempFilePath,
              success: () => {
                wx.showToast({
                  title: 'å·²ä¿å­˜åˆ°ç›¸å†Œ',
                  icon: 'success'
                })
              },
              fail: (err) => {
                console.error('ä¿å­˜åˆ°ç›¸å†Œå¤±è´¥', err)
                wx.showToast({
                  title: 'ä¿å­˜å¤±è´¥',
                  icon: 'none'
                })
              }
            })
          },
          fail: (err) => {
            console.error('ç”Ÿæˆå›¾ç‰‡å¤±è´¥', err)
          }
        })
      })
    },

    saveToFile() {
      const fileName = `translation_${new Date().getTime()}.txt`
      const filePath = `${wx.env.USER_DATA_PATH}/${fileName}`
      
      wx.getFileSystemManager().writeFile({
        filePath: filePath,
        data: this.data.translationResult,
        encoding: 'utf8',
        success: () => {
          wx.showToast({
            title: 'ä¿å­˜æˆåŠŸ',
            icon: 'success'
          })
          console.log('æ–‡ä»¶å·²ä¿å­˜åˆ°', filePath)
          
          wx.openDocument({
            filePath: filePath,
            success: function (res) {
              console.log('æ‰“å¼€æ–‡æ¡£æˆåŠŸ')
            },
            fail: function (res) {
              console.error('æ‰“å¼€æ–‡æ¡£å¤±è´¥', res)
              wx.showToast({
                title: 'æ‰“å¼€æ–‡ä»¶å¤±è´¥',
                icon: 'none'
              })
            }
          })
        },
        fail: (err) => {
          console.error('å†™å…¥æ–‡ä»¶å¤±è´¥', err)
          wx.showToast({
            title: 'ä¿å­˜å¤±è´¥',
            icon: 'none'
          })
        }
      })
    },
=======
    saveToAlbum() {
      const ctx = wx.createCanvasContext('translationCanvas')
      ctx.setFillStyle('#ffffff')
      ctx.fillRect(0, 0, 300, 450)
      ctx.setFontSize(14)
      ctx.setFillStyle('#000000')
      ctx.fillText(this.data.translationResult, 10, 30, 280)
      ctx.draw(false, () => {
        wx.canvasToTempFilePath({
          canvasId: 'translationCanvas',
          success: (res) => {
            wx.saveImageToPhotosAlbum({
              filePath: res.tempFilePath,
              success: () => {
                wx.showToast({
                  title: 'å·²ä¿å­˜åˆ°ç›¸å†Œ',
                  icon: 'success'
                })
                this.setData({ isDownloading: false })
              },
              fail: (err) => {
                console.error('ä¿å­˜åˆ°ç›¸å†Œå¤±è´¥', err)
                wx.showToast({
                  title: 'ä¿å­˜å¤±è´¥',
                  icon: 'none'
                })
                this.setData({ isDownloading: false })
              }
            })
          },
          fail: (err) => {
            console.error('ç”Ÿæˆå›¾ç‰‡å¤±è´¥', err)
            this.setData({ isDownloading: false })
          }
        })
      })
    },

    saveToFile() {
      const fileName = `translation_${new Date().getTime()}.txt`
      const filePath = `${wx.env.USER_DATA_PATH}/${fileName}`
      
      wx.getFileSystemManager().writeFile({
        filePath: filePath,
        data: this.data.translationResult,
        encoding: 'utf8',
        success: () => {
          wx.showToast({
            title: 'ä¿å­˜æˆåŠŸ',
            icon: 'success'
          })
          console.log('æ–‡ä»¶å·²ä¿å­˜åˆ°', filePath)
          
          wx.openDocument({
            filePath: filePath,
            success: function (res) {
              console.log('æ‰“å¼€æ–‡æ¡£æˆåŠŸ')
            },
            fail: function (res) {
              console.error('æ‰“å¼€æ–‡æ¡£å¤±è´¥', res)
              wx.showToast({
                title: 'æ‰“å¼€æ–‡ä»¶å¤±è´¥',
                icon: 'none'
              })
            }
          })
          this.setData({ isDownloading: false })
        },
        fail: (err) => {
          console.error('å†™å…¥æ–‡ä»¶å¤±è´¥', err)
          wx.showToast({
            title: 'ä¿å­˜å¤±è´¥',
            icon: 'none'
          })
          this.setData({ isDownloading: false })
        }
      })
    },
>>>>>>> REPLACE
```

æœ€åï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°ä¸€ä¸‹ index.scss æ–‡ä»¶æ¥æ·»åŠ æ–°çš„æ ·å¼ï¼š

```python
##File: /Users/allwefantasy/WeChatProjects/long-translate/miniprogram/pages/index/index.scss
<<<<<<< SEARCH
.download-button {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  background-color: #2196F3;
  color: white;
  font-size: 14px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;

  &:active {
    background-color: #1e88e5;
    transform: scale(0.98);
  }
}
=======
.button-group {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.download-button, .continue-button {
  width: 48%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  font-size: 14px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;

  &:active {
    transform: scale(0.98);
  }
}

.download-button {
  background-color: #2196F3;
  color: white;

  &:active {
    background-color: #1e88e5;
  }
}

.continue-button {
  background-color: #4CAF50;
  color: white;

  &:active {
    background-color: #45a049;
  }
}
>>>>>>> REPLACE
```

è¿™äº›ä¿®æ”¹å°†æ·»åŠ ä¸€ä¸ª"ç»§ç»­"æŒ‰é’®ï¼Œå½“ç”¨æˆ·å¤„äºä¸‹è½½çŠ¶æ€æ—¶å®ƒä¼šå‡ºç°ã€‚ç‚¹å‡»"ç»§ç»­"æŒ‰é’®å°†æ¸…é™¤å½“å‰çŠ¶æ€å¹¶è¿”å›åˆ°åˆå§‹çŠ¶æ€ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜æ”¹è¿›äº†ä¸‹è½½æŒ‰é’®çš„å¸ƒå±€ï¼Œä½¿å…¶ä¸æ–°æ·»åŠ çš„ç»§ç»­æŒ‰é’®å¹¶æ’æ˜¾ç¤ºã€‚